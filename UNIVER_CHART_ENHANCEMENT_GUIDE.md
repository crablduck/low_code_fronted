# Univer 报表设计器图表增强指南

## 📋 概述

本项目为 Univer 报表设计器扩展了强大的 AntV 图表能力，提供企业级的数据可视化解决方案。通过集成 AntV G2 图表引擎，实现了丰富的图表类型和专业的医疗行业主题配置。

## 🎯 主要功能特性

### 1. 多样化图表类型
- **柱状图** - 适合对比不同类别的数据
- **折线图** - 适合显示数据的趋势变化
- **饼图** - 适合显示数据的占比关系
- **面积图** - 适合显示累积数据
- **散点图** - 适合显示两个变量的相关性
- **条形图** - 适合显示分类数据的横向对比

### 2. 专业医疗主题
- **医疗蓝** - 专业稳重的蓝色系
- **科技绿** - 现代化的绿色系
- **温馨橙** - 温暖亲和的橙色系
- **专业灰** - 简约优雅的灰色系

### 3. 完整的集成流程
- Univer 电子表格编辑
- 实时数据提取和配置
- 图表预览和调整
- 一键插入到工作表

## 🚀 快速开始

### 访问方式
打开浏览器，访问：`http://localhost:3000/univer-enhanced-designer`

### 基本操作流程

#### 步骤1：准备数据
1. 在 Univer 工作表中输入或导入数据
2. 确保数据格式正确（第一行为标题，后续行为数据）

#### 步骤2：插入图表
1. 点击顶部工具栏的"插入图表"按钮
2. 在弹出的对话框中选择合适的图表类型
3. 系统会自动打开右侧图表配置面板

#### 步骤3：配置图表
1. **数据源配置**
   - 设置数据范围（如：A1:D10）
   - 选择X轴字段（通常为分类字段）
   - 选择Y轴字段（通常为数值字段）

2. **样式配置**
   - 输入图表标题
   - 选择医疗主题色彩
   - 设置是否显示图例

#### 步骤4：预览和插入
1. 在预览区域查看图表效果
2. 如需调整，修改配置后点击"更新预览"
3. 满意后点击"插入到工作表"

## 🏥 医疗行业应用场景

### 1. 患者统计分析
```
数据示例：
科室     | 患者数 | 收入   | 满意度
心内科   | 120    | 45.2   | 4.5
骨科     | 98     | 52.8   | 4.2
妇产科   | 156    | 38.6   | 4.8
```

**推荐图表类型：**
- 柱状图：科室患者数对比
- 折线图：月度患者数变化趋势
- 饼图：各科室患者占比分析

### 2. 收入分析报表
```
数据示例：
月份   | 门诊收入 | 住院收入 | 检查收入
1月    | 125.6    | 234.8    | 89.3
2月    | 134.2    | 267.1    | 92.7
3月    | 142.8    | 289.5    | 95.2
```

**推荐图表类型：**
- 面积图：收入构成分析
- 折线图：收入趋势变化
- 条形图：不同收入项目对比

### 3. 绩效评估看板
```
数据示例：
指标     | 目标值 | 实际值 | 完成率
门诊量   | 1500   | 1456   | 97.1%
手术量   | 250    | 267    | 106.8%
住院率   | 85%    | 88.2%  | 103.8%
```

**推荐图表类型：**
- 散点图：目标值与实际值相关性
- 柱状图：各指标完成情况对比
- 饼图：整体绩效完成度分布

## 🎨 主题色彩配置

### 医疗蓝主题
```css
colors: ['#1890ff', '#36cfc9', '#52c41a', '#faad14', '#f5222d']
```
- 适用场景：正式报告、官方统计
- 特点：专业、稳重、权威

### 科技绿主题
```css
colors: ['#52c41a', '#13c2c2', '#1890ff', '#722ed1', '#eb2f96']
```
- 适用场景：创新项目、健康监测
- 特点：现代、活力、环保

### 温馨橙主题
```css
colors: ['#fa8c16', '#faad14', '#fadb14', '#a0d911', '#52c41a']
```
- 适用场景：患者关怀、服务质量
- 特点：温暖、亲和、关爱

### 专业灰主题
```css
colors: ['#595959', '#8c8c8c', '#bfbfbf', '#d9d9d9', '#f0f0f0']
```
- 适用场景：财务报表、成本分析
- 特点：简约、优雅、专业

## 🔧 技术架构

### 核心技术栈
- **前端框架：** Vue 3 + TypeScript
- **电子表格：** Univer (开源版)
- **图表引擎：** AntV G2
- **UI组件：** Element Plus
- **样式处理：** SCSS

### 组件结构
```
UniverEnhancedReportDesigner.vue
├── 顶部工具栏 (Header)
├── 左侧面板 (Univer 工作表)
├── 右侧面板 (图表配置)
│   ├── 图表类型选择
│   ├── 数据源配置
│   ├── 样式配置
│   └── 图表预览
└── 图表插入对话框
```

### 数据流程
```
工作表数据 → 数据提取 → 字段映射 → 图表渲染 → 预览展示 → 插入工作表
```

## 📊 使用示例

### 示例1：创建患者满意度分析图

1. **准备数据**
   ```
   A1: 科室      B1: 满意度
   A2: 心内科    B2: 4.5
   A3: 骨科      B3: 4.2
   A4: 妇产科    B4: 4.8
   A5: 儿科      B5: 4.6
   ```

2. **配置图表**
   - 图表类型：柱状图
   - 数据范围：A1:B5
   - X轴字段：科室
   - Y轴字段：满意度
   - 主题：医疗蓝

### 示例2：创建月度收入趋势图

1. **准备数据**
   ```
   A1: 月份  B1: 收入
   A2: 1月   B2: 125.6
   A3: 2月   B3: 134.2
   A4: 3月   B4: 142.8
   ```

2. **配置图表**
   - 图表类型：折线图
   - 数据范围：A1:B4
   - X轴字段：月份
   - Y轴字段：收入
   - 主题：科技绿

## 🔧 高级功能

### 1. 自定义主题
用户可以通过修改配置文件自定义主题色彩：

```typescript
const customTheme = {
  'custom-theme': ['#color1', '#color2', '#color3', '#color4', '#color5']
}
```

### 2. 数据格式化
支持多种数据格式化选项：
- 数字千分位分隔
- 百分比显示
- 货币格式
- 日期格式

### 3. 交互功能
- 图表缩放
- 数据筛选
- 联动分析
- 钻取功能

## 🚀 性能优化

### 1. 图表渲染优化
- 使用 Canvas 渲染提升性能
- 大数据集分页加载
- 图表缓存机制

### 2. 内存管理
- 组件销毁时清理图表实例
- 避免内存泄漏
- 合理的数据更新频率

## 📱 移动端适配

虽然主要面向桌面端使用，但系统也考虑了移动端访问：
- 响应式布局设计
- 触摸手势支持
- 移动端优化的配置面板

## 🐛 常见问题

### Q1：图表不显示？
**A：** 检查以下项目：
1. 数据格式是否正确
2. 字段映射是否配置
3. 浏览器是否支持Canvas

### Q2：导出功能异常？
**A：** 确保：
1. 浏览器允许下载
2. 数据量不超过限制
3. 网络连接正常

### Q3：样式不正确？
**A：** 验证：
1. 主题配置是否正确
2. CSS样式是否加载
3. 组件版本是否匹配

## 🔄 更新日志

### v1.0.0 (2024-01-XX)
- ✅ 集成 AntV G2 图表引擎
- ✅ 实现 6 种基础图表类型
- ✅ 添加 4 套医疗主题
- ✅ 完善图表配置面板
- ✅ 实现图表预览功能

### v1.1.0 (计划中)
- 🔲 增加更多图表类型
- 🔲 支持自定义主题
- 🔲 添加图表动画效果
- 🔲 实现数据钻取功能

## 📞 技术支持

如遇到技术问题，请：
1. 查阅本文档的常见问题部分
2. 查看浏览器控制台错误信息
3. 联系技术支持团队

---

**注意：** 本系统基于开源技术构建，完全免费使用，无需购买商业许可证。所有图表功能均可在生产环境中使用。 