# Excel风格报表设计器使用指南 - 专业版

## 🚀 重磅更新！真正的Excel体验

### ✨ 全新特性

#### 🎛️ 完整Excel工具栏
- **文件操作**：新建、打开、保存、打印按钮
- **编辑功能**：撤销、重做操作
- **格式工具**：字体、字号、粗体/斜体/下划线
- **颜色控制**：文字颜色、背景填充
- **对齐方式**：左对齐、居中、右对齐
- **边框样式**：全边框、外边框、无边框
- **插入功能**：图片、图表、形状、链接（界面预留）
- **数据工具**：排序、筛选、数据透视表（界面预留）
- **合并功能**：合并单元格、拆分单元格（界面预留）

#### 📊 Excel公式栏
- **名称框**：显示当前选中单元格位置（如A1、B5）
- **fx标识**：标准Excel公式栏标识
- **公式输入**：输入公式或值，按Enter确认

#### 📱 可折叠数据源面板
- **一键折叠**：点击顶部"隐藏面板"按钮
- **智能展开**：再次点击"显示面板"恢复
- **更大表格**：折叠后表格占满全屏

#### 📈 大型Excel表格
- **50列显示**：从A列到AX列（A-Z + AA-AX）
- **100行数据**：真正Excel规模的数据展示
- **流畅滚动**：专业滚动条，支持大数据量
- **标准尺寸**：80px×21px标准Excel单元格

## 🎯 功能特色

### ✅ 真实数据源集成
- **自动加载**：从 `http://localhost:6001/api/tables` 动态获取数据表列表
- **支持的数据表**：dashboards, Department, Organization, reports, Role, User, UserDepartment, UserOrganization, UserRole 等
- **智能过滤**：自动过滤系统表（以_开头的表）和视图，只显示业务数据表

### ✅ 专业Excel界面
- **多层工具栏**：主工具栏 + 公式栏，完全Excel风格
- **医疗绿主题**：专业医疗行业配色(#107c41)
- **响应式设计**：自适应不同屏幕尺寸
- **专业图标**：Element Plus官方图标集

### ✅ 数据字段映射
- **拖拽绑定**：从右侧字段列表拖拽到表格列标题
- **可视化反馈**：绑定后列标题显示绿色背景
- **类型识别**：自动识别数据库字段类型（VARCHAR→字符串，INT→数字，DATETIME→日期）

### ✅ 计算字段系统
- **表达式编辑**：支持JavaScript表达式语法
- **条件判断**：`age > 60 ? '老年' : '非老年'`
- **数学运算**：`salary * 12` 计算年薪
- **字符串处理**：`username + '@company.com'` 生成邮箱

### ✅ 手动渲染控制
- **绿色渲染按钮**：主工具栏右侧醒目的"更新渲染"按钮
- **性能优化**：避免实时计算造成的性能问题
- **批量处理**：一次性处理所有绑定字段和计算字段

## 🚀 使用流程

### 第一步：界面布局设置
1. **调整面板**：
   - 需要更大表格空间？点击"隐藏面板"
   - 需要配置数据源？点击"显示面板"
2. **选择工作区域**：
   - 表格现支持50列×100行，真正Excel规模
   - 使用滚动条浏览大表格

### 第二步：选择数据源
1. 在右侧面板选择数据源下拉框
2. 系统自动从6001接口加载真实数据表：
   ```
   • Department（部门表）
   • Organization（组织表）  
   • User（用户表）
   • Role（角色表）
   • reports（报表表）
   • dashboards（仪表盘表）
   ```
3. 选择后自动加载表结构和数据预览

### 第三步：字段拖拽绑定
1. 查看右侧"原始字段"列表，显示所选数据表的所有字段
2. 将需要的字段拖拽到Excel表格的列标题（A、B、C...AX）
3. 成功绑定后列标题显示绿色背景和字段名称

### 第四步：创建计算字段（可选）
1. 在"创建计算字段"区域输入：
   - **字段名称**：如"年龄分组"
   - **计算表达式**：如`age > 30 ? '中年' : '青年'`
   - **字段类型**：选择返回值类型
2. 点击"创建字段"
3. 新字段出现在"计算字段"列表，可以拖拽使用

### 第五步：使用公式栏
1. **单元格选择**：点击任意单元格，名称框显示位置（如A1）
2. **公式输入**：在公式栏输入值或公式
3. **确认输入**：按Enter键应用到当前单元格

### 第六步：渲染数据
1. 完成字段绑定后，点击主工具栏的绿色"**更新渲染**"按钮
2. 系统自动：
   - 计算所有计算字段的表达式
   - 将数据填充到绑定的表格列中
   - 显示成功提示："数据渲染完成"

### 第七步：Excel格式化
使用完整Excel工具栏美化表格：
- **文件操作**：保存设计配置
- **字体设置**：选择微软雅黑、宋体等字体，调整字号
- **格式化**：应用粗体、斜体、下划线样式
- **颜色美化**：设置文字颜色和背景色
- **边框控制**：添加表格边框样式
- **对齐方式**：左对齐、居中、右对齐

## 📊 界面说明

### 顶部主工具栏
- **文件组**：新建、打开、保存、打印
- **编辑组**：撤销、重做
- **格式组**：字体、字号、粗体/斜体/下划线
- **颜色组**：文字颜色、背景填充
- **边框组**：边框样式选择
- **对齐组**：文本对齐方式
- **插入组**：图片、图表、形状、链接（预留功能）
- **数据组**：排序、筛选、数据透视表（预留功能）
- **合并组**：合并/拆分单元格（预留功能）
- **渲染按钮**：绿色"更新渲染"按钮

### Excel公式栏
- **名称框（左侧）**：显示当前选中单元格引用（如A1、B5）
- **fx标识（中间）**：标准Excel公式标识
- **公式输入框（右侧）**：输入公式或值，支持Enter确认

### 大型Excel表格
- **列标题**：A-AX（50列），绑定字段显示绿色背景
- **行标题**：1-100行，标准Excel行号
- **单元格**：80px×21px，标准Excel尺寸
- **选中状态**：蓝色边框高亮，Excel风格

### 右侧数据面板（可折叠）
- **数据源配置**：表选择和数据预览
- **原始字段**：拖拽式字段列表
- **计算字段创建**：表达式编辑器
- **绑定状态**：当前字段绑定情况

## 🎨 专业设计

### 医疗行业主题
- **主色调**：医疗绿(#107c41)，专业可信
- **辅助色**：Excel蓝(#0078d4)，操作高亮
- **背景色**：浅灰(#f8f9fa)，护眼舒适

### Excel完全兼容
- **标准尺寸**：完全符合Excel的单元格和工具栏尺寸
- **专业图标**：使用Element Plus官方图标集
- **交互体验**：单击选择、双击编辑、拖拽操作

## 🔧 故障排除

### 界面显示问题
1. **工具栏过挤**：
   - 调整浏览器窗口大小
   - 系统已适配1200px以下屏幕
2. **表格太小**：
   - 点击"隐藏面板"获得全屏表格
   - 使用滚动条浏览50列×100行

### 数据源加载失败
1. 确认6001接口服务正常运行
2. 检查网络连接
3. 查看浏览器控制台错误信息
4. 系统会自动回退到模拟数据

### 字段拖拽无效
1. 确保拖拽到列标题区域（A、B、C等）
2. 检查字段是否已经绑定到其他列
3. 尝试刷新页面重新操作

### 计算字段错误
1. 检查表达式语法是否正确
2. 确认引用的字段名称存在
3. 查看字段类型是否匹配
4. 使用简单表达式进行测试

## 🎯 未来功能预览

当前界面已预留以下功能位置：
- **插入图片**：支持图片上传和展示
- **插入图表**：基于数据生成各种图表
- **插入形状**：添加图形元素
- **数据排序**：多字段排序功能
- **数据筛选**：高级筛选条件
- **数据透视表**：复杂数据分析
- **合并单元格**：Excel样式单元格合并

现在您拥有了真正专业级的Excel风格报表设计器！🎉 