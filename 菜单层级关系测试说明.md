# 菜单层级关系功能测试说明

## 功能概述
实现了完整的菜单层级关系功能：
1. **表单向导**: 支持树形菜单选择器，可以选择任意层级的菜单作为挂载位置
2. **导航栏**: 支持显示子菜单的层级结构

## 实现效果

### 🎯 表单向导菜单选择器改进
- **之前**: 只能选择顶级菜单
- **现在**: 使用树形选择器，支持展开查看和选择子菜单

### 🧭 导航栏菜单改进  
- **之前**: 只显示顶级菜单的平铺列表
- **现在**: 支持下拉子菜单，显示完整的层级结构

### 📋 当前菜单结构
根据后端API数据，系统中的菜单层级关系如下：

#### 顶级菜单及其子菜单
1. **系统管理** 
   - 用户管理
   - 角色管理  
   - 权限管理

2. **业务管理** 
   - 业务流程
   - 表单管理

3. **数据管理** 
   - 数据源管理
   - 数据表管理

4. **报表管理** (无子菜单)

## 测试步骤

### 1. 测试导航栏子菜单显示
访问: `http://localhost:3003`

**预期效果**:
- 导航栏显示: 首页 | 表单设计器 | 系统管理 ▼ | 业务管理 ▼ | 数据管理 ▼ | 报表管理 | 更多 ▼
- 鼠标悬停"系统管理"时，下拉显示: 用户管理、角色管理、权限管理
- 鼠标悬停"业务管理"时，下拉显示: 业务流程、表单管理
- 鼠标悬停"数据管理"时，下拉显示: 数据源管理、数据表管理
- "报表管理"无下拉菜单（因为没有子菜单）

### 2. 测试表单向导树形菜单选择器
访问: `http://localhost:3003/form-designer`

**操作步骤**:
1. 点击"快速创建表单"按钮
2. 完成第一步和第二步
3. 在第三步"页面配置"中：
   - 开启"自动生成菜单"开关
   - 点击"菜单挂载位置"树形选择器

**预期效果**:
```
📁 系统管理
  ├── 用户管理
  ├── 角色管理  
  └── 权限管理
📁 业务管理
  ├── 业务流程
  └── 表单管理
📁 数据管理
  ├── 数据源管理
  └── 数据表管理
📄 报表管理
```

**可选择任意菜单**:
- 可以选择顶级菜单（如"业务管理"）
- 也可以选择子菜单（如"表单管理"）
- 新创建的菜单将作为子菜单添加到选中的菜单下

### 3. 验证完整流程
1. 在树形选择器中选择"业务管理 > 表单管理"
2. 完成表单创建
3. 检查导航栏"业务管理"下拉菜单，应该新增一个子菜单项

## 技术实现

### 表单向导 - 树形选择器
```vue
<el-tree-select
  v-model="formConfig.page.parentMenu"
  :data="menuTreeData"
  :props="{ label: 'name', value: 'id', children: 'children' }"
  check-strictly
  show-checkbox
  :render-after-expand="false"
/>
```

```typescript
// 构建菜单树形数据
const menuTreeData = computed(() => {
  const buildTree = (parentId: number | null = null): any[] => {
    return menuList.value
      .filter(menu => menu.parent_id === parentId)
      .map(menu => ({
        id: menu.id,
        name: menu.name,
        path: menu.path,
        icon: menu.icon,
        children: buildTree(menu.id)
      }))
  }
  return buildTree()
})
```

### 导航栏 - 子菜单显示
```vue
<template v-for="menu in topLevelMenus" :key="menu.id">
  <!-- 有子菜单的父菜单 -->
  <el-sub-menu v-if="getChildren(menu).length > 0" :index="menu.path">
    <template #title>
      <el-icon><component :is="getMenuIcon(menu.icon)" /></el-icon>
      <span>{{ menu.name }}</span>
    </template>
    <!-- 子菜单 -->
    <el-menu-item 
      v-for="childMenu in getChildren(menu)" 
      :key="childMenu.id"
      :index="childMenu.path"
    >
      <el-icon><component :is="getMenuIcon(childMenu.icon)" /></el-icon>
      <span>{{ childMenu.name }}</span>
    </el-menu-item>
  </el-sub-menu>
  
  <!-- 没有子菜单的顶级菜单 -->
  <el-menu-item v-else :index="menu.path">
    <el-icon><component :is="getMenuIcon(menu.icon)" /></el-icon>
    <span>{{ menu.name }}</span>
  </el-menu-item>
</template>
```

## 预期结果
✅ 导航栏正确显示父子菜单的层级结构  
✅ 表单向导支持树形菜单选择器  
✅ 可以选择任意层级的菜单作为挂载位置  
✅ 新创建的菜单正确添加到选中的位置  
✅ 菜单更新后导航栏自动刷新显示 