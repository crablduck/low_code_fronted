# 数据库集成功能演示

## 🎯 完整低代码功能链路演示

### 1. 数据源配置区域

访问 `http://localhost:3000/form-design`，页面顶部显示数据源配置区域：

```
┌─────────────────────────────────────────────────────────────────┐
│ 数据源配置                                    [MySQL主库] ✓     │
├─────────────────────────────────────────────────────────────────┤
│ [目标数据库▼] [数据表▼] [表名称______] [从表结构生成字段]      │
│  MySQL主库     patients   patients                              │
└─────────────────────────────────────────────────────────────────┘
```

**功能特点：**
- ✅ 支持多种数据库类型（MySQL、PostgreSQL、SQLite）
- ✅ 实时显示数据源连接状态
- ✅ 动态加载数据表列表
- ✅ 智能表名生成

### 2. 从数据表自动生成字段

选择数据源和数据表后，点击"从表结构生成字段"：

**操作步骤：**
1. 选择"MySQL主库"数据源
2. 选择"patients"数据表
3. 点击"从表结构生成字段"按钮

**自动生成结果：**
```json
[
  {
    "field": "name",
    "label": "患者姓名", 
    "type": "text",
    "required": true
  },
  {
    "field": "gender",
    "label": "性别",
    "type": "radio", 
    "options": ["男", "女"]
  },
  {
    "field": "age",
    "label": "年龄",
    "type": "number"
  },
  {
    "field": "phone", 
    "label": "联系电话",
    "type": "text"
  },
  {
    "field": "address",
    "label": "地址", 
    "type": "textarea"
  }
]
```

### 3. 表单设计器界面

```
┌─────────────┬─────────────────────────┬─────────────────┐
│  组件库     │       设计画布          │   属性配置      │
├─────────────┼─────────────────────────┼─────────────────┤
│ 基础组件    │                         │ [字段属性]      │
│ □ 文本输入  │  ┌─────────────────┐    │ 字段名: name    │
│ □ 数字输入  │  │ 患者姓名        │    │ 标签: 患者姓名  │
│ □ 下拉选择  │  │ [_____________] │    │ 必填: ☑        │
│ □ 单选框    │  └─────────────────┘    │                 │
│ □ 多选框    │                         │ [数据配置]      │
│ □ 日期选择  │  ┌─────────────────┐    │ 接口路径:       │
│ □ 多行文本  │  │ 性别            │    │ /api/data       │
│             │  │ ○男 ○女         │    │                 │
│             │  └─────────────────┘    │ 字段映射:       │
│             │                         │ name→patient_name│
└─────────────┴─────────────────────────┴─────────────────┘
```

### 4. 数据配置功能

在右侧属性面板的"数据配置"标签页：

**接口路径配置：**
```
接口路径: /api/data
说明: 表单提交时的API接口地址
```

**字段映射配置：**
```
┌─────────┬─────────┬─────────────┐
│ 字段名  │ 标签    │ 映射名称    │
├─────────┼─────────┼─────────────┤
│ name    │ 患者姓名│ patient_name│
│ gender  │ 性别    │ gender      │
│ age     │ 年龄    │ age         │
│ phone   │ 联系电话│ phone       │
│ address │ 地址    │ address     │
└─────────┴─────────┴─────────────┘
```

**Schema预览：**
```json
{
  "formName": "患者登记表单",
  "dataSourceId": 1,
  "tableName": "patients", 
  "fields": [...],
  "apiEndpoint": "/api/data",
  "fieldMapping": {
    "name": "patient_name",
    "gender": "gender",
    "age": "age",
    "phone": "phone", 
    "address": "address"
  }
}
```

### 5. 验证机制

**数据源验证：**
- ❌ 未选择数据源时，保存按钮禁用
- ⚠️ 提示："请先选择数据库"

**表单验证：**
- ❌ 表单名称为空时，提示："请输入表单名称"
- ❌ 无字段时，提示："请至少添加一个字段"

### 6. 工作流程演示

**完整操作流程：**

1. **选择数据源**
   ```
   数据源: MySQL主库 ✓
   状态: 已连接
   ```

2. **选择数据表**
   ```
   数据表: patients (患者信息表)
   字段数: 7个
   ```

3. **生成字段**
   ```
   点击"从表结构生成字段" → 自动生成5个表单字段
   成功提示: "成功从表 patients 生成 5 个字段"
   ```

4. **配置映射**
   ```
   字段映射: name → patient_name
   接口路径: /api/data
   ```

5. **保存表单**
   ```
   验证通过 → 生成完整Schema → 保存成功
   ```

### 7. API测试结果

**数据源API：**
```bash
curl http://localhost:3003/api/data-sources
# 返回3个数据源（MySQL、PostgreSQL、SQLite）
```

**表列表API：**
```bash
curl http://localhost:3003/api/table-list?db=1  
# 返回3个表（patients、medical_records、departments）
```

**字段生成API：**
```bash
curl http://localhost:3003/api/table-fields/patients?db=1
# 返回5个表单字段配置
```

### 8. 技术实现亮点

**前端技术栈：**
- Vue 3 + TypeScript + Element Plus
- 响应式数据绑定
- 拖拽式表单设计
- 实时预览功能

**后端Mock服务：**
- Express.js + JSON Server
- RESTful API设计
- 智能字段类型映射
- 完整的数据模拟

**核心特性：**
- 🎯 完整的低代码链路
- 🔄 数据库表结构自动映射
- 🎨 可视化表单设计
- 📊 实时Schema生成
- ✅ 完整的验证机制

---

## 🚀 快速体验

1. **启动服务：**
   ```bash
   # 启动Mock服务器
   cd mock-server && npm start
   
   # 启动前端服务  
   npm run dev
   ```

2. **访问地址：**
   ```
   表单设计器: http://localhost:3000/form-design
   Mock API: http://localhost:3003/api
   ```

3. **体验流程：**
   - 选择"MySQL主库"数据源
   - 选择"patients"数据表
   - 点击"从表结构生成字段"
   - 查看自动生成的表单字段
   - 配置字段映射关系
   - 预览和保存表单

**🎉 恭喜！您已成功体验完整的数据库集成低代码功能！** 