{
  "info": {
    "name": "Univer报表管理API",
    "description": "医疗行业Univer报表管理系统API接口集合，支持报表CRUD、数据源集成、模板管理等功能",
    "version": "1.0.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Univer报表管理",
      "item": [
        {
          "name": "获取报表列表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports?page=1&pageSize=12&keyword=&category=&status=",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "页码，从1开始"
                },
                {
                  "key": "pageSize",
                  "value": "12",
                  "description": "每页数量"
                },
                {
                  "key": "keyword",
                  "value": "",
                  "description": "搜索关键词（报表名称或描述）"
                },
                {
                  "key": "category",
                  "value": "",
                  "description": "报表分类：patient|finance|medicine|workload|bed|other"
                },
                {
                  "key": "status",
                  "value": "",
                  "description": "报表状态：draft|published|archived"
                }
              ]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports?page=1&pageSize=12",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "pageSize",
                      "value": "12"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"获取成功\",\n  \"data\": {\n    \"list\": [\n      {\n        \"id\": \"report_001\",\n        \"name\": \"患者统计报表\",\n        \"description\": \"医院患者基础信息统计分析\",\n        \"category\": \"patient\",\n        \"status\": \"published\",\n        \"template\": \"patient-stats\",\n        \"createdAt\": \"2024-01-01T10:00:00Z\",\n        \"updatedAt\": \"2024-01-01T15:30:00Z\",\n        \"createdBy\": \"user_123\"\n      }\n    ],\n    \"total\": 1,\n    \"page\": 1,\n    \"pageSize\": 12\n  }\n}"
            }
          ]
        },
        {
          "name": "获取报表详情",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports/{{reportId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports", "{{reportId}}"]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports/report_001",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports", "report_001"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"获取成功\",\n  \"data\": {\n    \"id\": \"report_001\",\n    \"name\": \"患者统计报表\",\n    \"description\": \"医院患者基础信息统计分析\",\n    \"category\": \"patient\",\n    \"status\": \"published\",\n    \"template\": \"patient-stats\",\n    \"data\": [\n      [\"患者ID\", \"姓名\", \"年龄\", \"性别\", \"科室\"],\n      [\"P001\", \"张三\", 35, \"男\", \"心内科\"],\n      [\"P002\", \"李四\", 28, \"女\", \"妇产科\"]\n    ],\n    \"createdAt\": \"2024-01-01T10:00:00Z\",\n    \"updatedAt\": \"2024-01-01T15:30:00Z\",\n    \"createdBy\": \"user_123\"\n  }\n}"
            }
          ]
        },
        {
          "name": "创建报表",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"新建患者统计报表\",\n  \"description\": \"用于分析患者基础信息的统计报表\",\n  \"category\": \"patient\",\n  \"template\": \"patient-stats\",\n  \"status\": \"draft\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports"]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"新建患者统计报表\",\n  \"description\": \"用于分析患者基础信息的统计报表\",\n  \"category\": \"patient\",\n  \"template\": \"patient-stats\",\n  \"status\": \"draft\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 201,\n  \"message\": \"创建成功\",\n  \"data\": {\n    \"id\": \"report_002\",\n    \"name\": \"新建患者统计报表\",\n    \"description\": \"用于分析患者基础信息的统计报表\",\n    \"category\": \"patient\",\n    \"status\": \"draft\",\n    \"template\": \"patient-stats\",\n    \"createdAt\": \"2024-01-01T16:00:00Z\",\n    \"updatedAt\": \"2024-01-01T16:00:00Z\",\n    \"createdBy\": \"user_123\"\n  }\n}"
            }
          ]
        },
        {
          "name": "更新报表",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"更新后的患者统计报表\",\n  \"description\": \"更新后的描述信息\",\n  \"category\": \"patient\",\n  \"status\": \"published\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports/{{reportId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports", "{{reportId}}"]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"更新后的患者统计报表\",\n  \"description\": \"更新后的描述信息\",\n  \"category\": \"patient\",\n  \"status\": \"published\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports/report_002",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports", "report_002"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"更新成功\",\n  \"data\": {\n    \"id\": \"report_002\",\n    \"name\": \"更新后的患者统计报表\",\n    \"description\": \"更新后的描述信息\",\n    \"category\": \"patient\",\n    \"status\": \"published\",\n    \"template\": \"patient-stats\",\n    \"createdAt\": \"2024-01-01T16:00:00Z\",\n    \"updatedAt\": \"2024-01-01T17:00:00Z\",\n    \"createdBy\": \"user_123\"\n  }\n}"
            }
          ]
        },
        {
          "name": "保存报表数据",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"data\": [\n    [\"患者ID\", \"姓名\", \"年龄\", \"性别\", \"科室\", \"诊断\", \"费用\"],\n    [\"P001\", \"张三\", 35, \"男\", \"心内科\", \"高血压\", 1500.50],\n    [\"P002\", \"李四\", 28, \"女\", \"妇产科\", \"产检\", 800.00],\n    [\"P003\", \"王五\", 45, \"男\", \"骨科\", \"骨折\", 3200.00]\n  ],\n  \"formulas\": {\n    \"G4\": \"=SUM(G2:G4)\",\n    \"H2\": \"=IF(G2>2000,\\\"高费用\\\",\\\"正常\\\")\"\n  },\n  \"styles\": {\n    \"A1:G1\": {\n      \"fontWeight\": \"bold\",\n      \"backgroundColor\": \"#f0f9ff\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports/{{reportId}}/data",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports", "{{reportId}}", "data"]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"data\": [\n    [\"患者ID\", \"姓名\", \"年龄\", \"性别\", \"科室\", \"诊断\", \"费用\"],\n    [\"P001\", \"张三\", 35, \"男\", \"心内科\", \"高血压\", 1500.50],\n    [\"P002\", \"李四\", 28, \"女\", \"妇产科\", \"产检\", 800.00],\n    [\"P003\", \"王五\", 45, \"男\", \"骨科\", \"骨折\", 3200.00]\n  ]\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports/report_002/data",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports", "report_002", "data"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"数据保存成功\",\n  \"data\": {\n    \"reportId\": \"report_002\",\n    \"savedAt\": \"2024-01-01T17:30:00Z\",\n    \"dataSize\": 4\n  }\n}"
            }
          ]
        },
        {
          "name": "删除报表",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports/{{reportId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports", "{{reportId}}"]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports/report_002",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports", "report_002"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"删除成功\"\n}"
            }
          ]
        },
        {
          "name": "复制报表",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports/{{reportId}}/copy",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports", "{{reportId}}", "copy"]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports/report_001/copy",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports", "report_001", "copy"]
                }
              },
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 201,\n  \"message\": \"复制成功\",\n  \"data\": {\n    \"id\": \"report_003\",\n    \"name\": \"患者统计报表 - 副本\",\n    \"description\": \"医院患者基础信息统计分析\",\n    \"category\": \"patient\",\n    \"status\": \"draft\",\n    \"template\": \"patient-stats\",\n    \"createdAt\": \"2024-01-01T18:00:00Z\",\n    \"updatedAt\": \"2024-01-01T18:00:00Z\",\n    \"createdBy\": \"user_123\"\n  }\n}"
            }
          ]
        },
        {
          "name": "导出报表",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/univer-reports/{{reportId}}/export?format=xlsx",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-reports", "{{reportId}}", "export"],
              "query": [
                {
                  "key": "format",
                  "value": "xlsx",
                  "description": "导出格式：xlsx|pdf|csv"
                }
              ]
            }
          },
          "response": [
            {
              "name": "成功响应",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/univer-reports/report_001/export?format=xlsx",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-reports", "report_001", "export"],
                  "query": [
                    {
                      "key": "format",
                      "value": "xlsx"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"导出成功\",\n  \"data\": {\n    \"downloadUrl\": \"https://example.com/downloads/report_001_20240101.xlsx\",\n    \"fileName\": \"患者统计报表_20240101.xlsx\",\n    \"fileSize\": 25600\n  }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "数据集集成",
      "item": [
        {
          "name": "查询数据集数据",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"queryType\": \"single\",\n  \"queryConfig\": {\n    \"tableName\": \"patients\",\n    \"dimensions\": [\"patient_name\", \"gender\", \"department\"],\n    \"metrics\": [\"age\", \"cost\"],\n    \"filters\": [\n      {\n        \"field\": \"department\",\n        \"operator\": \"in\",\n        \"value\": [\"心内科\", \"骨科\"]\n      },\n      {\n        \"field\": \"age\",\n        \"operator\": \"between\",\n        \"value\": [20, 60]\n      }\n    ],\n    \"orderBy\": [\n      {\n        \"field\": \"cost\",\n        \"direction\": \"desc\"\n      }\n    ],\n    \"limit\": 100\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/datasets/{{datasetId}}/query",
              "host": ["{{baseUrl}}"],
              "path": ["api", "datasets", "{{datasetId}}", "query"]
            }
          },
          "response": [
            {
              "name": "单表查询成功",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"queryType\": \"single\",\n  \"queryConfig\": {\n    \"tableName\": \"patients\",\n    \"dimensions\": [\"patient_name\", \"gender\", \"department\"],\n    \"metrics\": [\"age\", \"cost\"],\n    \"filters\": [\n      {\n        \"field\": \"department\",\n        \"operator\": \"in\",\n        \"value\": [\"心内科\", \"骨科\"]\n      }\n    ],\n    \"limit\": 100\n  }\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/datasets/dataset_001/query",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "datasets", "dataset_001", "query"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"查询成功\",\n  \"data\": {\n    \"fields\": [\n      {\"name\": \"patient_name\", \"type\": \"string\", \"title\": \"患者姓名\"},\n      {\"name\": \"gender\", \"type\": \"string\", \"title\": \"性别\"},\n      {\"name\": \"department\", \"type\": \"string\", \"title\": \"科室\"},\n      {\"name\": \"age\", \"type\": \"number\", \"title\": \"年龄\"},\n      {\"name\": \"cost\", \"type\": \"number\", \"title\": \"费用\"}\n    ],\n    \"rows\": [\n      [\"张三\", \"男\", \"心内科\", 35, 1500.50],\n      [\"李四\", \"女\", \"骨科\", 28, 3200.00],\n      [\"王五\", \"男\", \"心内科\", 45, 2100.75]\n    ],\n    \"total\": 3,\n    \"executionTime\": 150\n  }\n}"
            }
          ]
        },
        {
          "name": "多表关联查询",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"queryType\": \"multi\",\n  \"queryConfig\": {\n    \"mainTable\": \"patients\",\n    \"joins\": [\n      {\n        \"table\": \"departments\",\n        \"type\": \"LEFT\",\n        \"condition\": \"patients.department_id = departments.id\"\n      },\n      {\n        \"table\": \"doctors\",\n        \"type\": \"LEFT\",\n        \"condition\": \"patients.doctor_id = doctors.id\"\n      }\n    ],\n    \"dimensions\": [\n      \"patients.patient_name\",\n      \"departments.name as department_name\",\n      \"doctors.name as doctor_name\"\n    ],\n    \"metrics\": [\n      \"patients.age\",\n      \"patients.cost\"\n    ],\n    \"filters\": [\n      {\n        \"field\": \"departments.name\",\n        \"operator\": \"like\",\n        \"value\": \"%内科%\"\n      }\n    ],\n    \"groupBy\": [\"departments.name\"],\n    \"having\": [\n      {\n        \"field\": \"COUNT(patients.id)\",\n        \"operator\": \">\",\n        \"value\": 5\n      }\n    ],\n    \"orderBy\": [\n      {\n        \"field\": \"AVG(patients.cost)\",\n        \"direction\": \"desc\"\n      }\n    ],\n    \"limit\": 50\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/datasets/{{datasetId}}/query",
              "host": ["{{baseUrl}}"],
              "path": ["api", "datasets", "{{datasetId}}", "query"]
            }
          },
          "response": [
            {
              "name": "多表查询成功",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"queryType\": \"multi\",\n  \"queryConfig\": {\n    \"mainTable\": \"patients\",\n    \"joins\": [\n      {\n        \"table\": \"departments\",\n        \"type\": \"LEFT\",\n        \"condition\": \"patients.department_id = departments.id\"\n      }\n    ],\n    \"dimensions\": [\"patients.patient_name\", \"departments.name as department_name\"],\n    \"metrics\": [\"patients.age\", \"patients.cost\"]\n  }\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/datasets/dataset_002/query",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "datasets", "dataset_002", "query"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"查询成功\",\n  \"data\": {\n    \"fields\": [\n      {\"name\": \"patient_name\", \"type\": \"string\", \"title\": \"患者姓名\"},\n      {\"name\": \"department_name\", \"type\": \"string\", \"title\": \"科室名称\"},\n      {\"name\": \"age\", \"type\": \"number\", \"title\": \"年龄\"},\n      {\"name\": \"cost\", \"type\": \"number\", \"title\": \"费用\"}\n    ],\n    \"rows\": [\n      [\"张三\", \"心血管内科\", 35, 1500.50],\n      [\"李四\", \"神经内科\", 42, 2200.75],\n      [\"王五\", \"消化内科\", 38, 1800.25]\n    ],\n    \"total\": 3,\n    \"executionTime\": 280\n  }\n}"
            }
          ]
        },
        {
          "name": "自定义SQL查询",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"queryType\": \"sql\",\n  \"queryConfig\": {\n    \"sql\": \"SELECT d.name as department_name, COUNT(p.id) as patient_count, AVG(p.age) as avg_age, SUM(p.cost) as total_cost FROM patients p LEFT JOIN departments d ON p.department_id = d.id WHERE p.created_at >= '2024-01-01' GROUP BY d.name HAVING COUNT(p.id) > 10 ORDER BY total_cost DESC LIMIT 10\",\n    \"parameters\": {\n      \"start_date\": \"2024-01-01\",\n      \"min_patient_count\": 10\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/datasets/{{datasetId}}/query",
              "host": ["{{baseUrl}}"],
              "path": ["api", "datasets", "{{datasetId}}", "query"]
            }
          },
          "response": [
            {
              "name": "SQL查询成功",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"queryType\": \"sql\",\n  \"queryConfig\": {\n    \"sql\": \"SELECT d.name as department_name, COUNT(p.id) as patient_count, AVG(p.age) as avg_age, SUM(p.cost) as total_cost FROM patients p LEFT JOIN departments d ON p.department_id = d.id GROUP BY d.name ORDER BY total_cost DESC LIMIT 10\"\n  }\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/datasets/dataset_003/query",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "datasets", "dataset_003", "query"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"查询成功\",\n  \"data\": {\n    \"fields\": [\n      {\"name\": \"department_name\", \"type\": \"string\", \"title\": \"科室名称\"},\n      {\"name\": \"patient_count\", \"type\": \"number\", \"title\": \"患者数量\"},\n      {\"name\": \"avg_age\", \"type\": \"number\", \"title\": \"平均年龄\"},\n      {\"name\": \"total_cost\", \"type\": \"number\", \"title\": \"总费用\"}\n    ],\n    \"rows\": [\n      [\"心血管内科\", 45, 52.3, 125600.50],\n      [\"神经内科\", 38, 48.7, 98750.25],\n      [\"消化内科\", 32, 45.2, 76340.80]\n    ],\n    \"total\": 3,\n    \"executionTime\": 450\n  }\n}"
            }
          ]
        },
        {
          "name": "预览数据集数据",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"queryType\": \"single\",\n  \"queryConfig\": {\n    \"tableName\": \"patients\",\n    \"dimensions\": [\"patient_name\", \"gender\"],\n    \"metrics\": [\"age\"],\n    \"limit\": 5\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/datasets/{{datasetId}}/preview",
              "host": ["{{baseUrl}}"],
              "path": ["api", "datasets", "{{datasetId}}", "preview"]
            }
          },
          "response": [
            {
              "name": "预览成功",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"queryType\": \"single\",\n  \"queryConfig\": {\n    \"tableName\": \"patients\",\n    \"dimensions\": [\"patient_name\", \"gender\"],\n    \"metrics\": [\"age\"],\n    \"limit\": 5\n  }\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/datasets/dataset_001/preview",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "datasets", "dataset_001", "preview"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"预览成功\",\n  \"data\": {\n    \"fields\": [\n      {\"name\": \"patient_name\", \"type\": \"string\", \"title\": \"患者姓名\"},\n      {\"name\": \"gender\", \"type\": \"string\", \"title\": \"性别\"},\n      {\"name\": \"age\", \"type\": \"number\", \"title\": \"年龄\"}\n    ],\n    \"rows\": [\n      [\"张三\", \"男\", 35],\n      [\"李四\", \"女\", 28],\n      [\"王五\", \"男\", 45],\n      [\"赵六\", \"女\", 32],\n      [\"钱七\", \"男\", 29]\n    ],\n    \"total\": 5,\n    \"isPreview\": true\n  }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "报表模板",
      "item": [
        {
          "name": "获取报表模板",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/univer-report-templates/{{templateKey}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "univer-report-templates", "{{templateKey}}"]
            }
          },
          "response": [
            {
              "name": "获取模板成功",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/univer-report-templates/patient-stats",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "univer-report-templates", "patient-stats"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"code\": 200,\n  \"message\": \"获取成功\",\n  \"data\": {\n    \"templateKey\": \"patient-stats\",\n    \"name\": \"患者统计报表模板\",\n    \"description\": \"医院患者基础信息统计分析模板\",\n    \"category\": \"patient\",\n    \"data\": [\n      [\"患者ID\", \"姓名\", \"年龄\", \"性别\", \"科室\", \"诊断\", \"入院日期\", \"费用\", \"满意度\"],\n      [\"P001\", \"示例患者1\", 35, \"男\", \"心内科\", \"高血压\", \"2024-01-01\", 1500.50, 4.5],\n      [\"P002\", \"示例患者2\", 28, \"女\", \"妇产科\", \"产检\", \"2024-01-02\", 800.00, 4.8],\n      [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"=SUM(H2:H3)\", \"=AVERAGE(I2:I3)\"]\n    ],\n    \"formulas\": {\n      \"H4\": \"=SUM(H2:H3)\",\n      \"I4\": \"=AVERAGE(I2:I3)\"\n    },\n    \"styles\": {\n      \"A1:I1\": {\n        \"fontWeight\": \"bold\",\n        \"backgroundColor\": \"#e3f2fd\",\n        \"textAlign\": \"center\"\n      },\n      \"H4:I4\": {\n        \"fontWeight\": \"bold\",\n        \"backgroundColor\": \"#f3e5f5\"\n      }\n    }\n  }\n}"
            }
          ]
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:6001",
      "type": "string",
      "description": "API基础URL - 根据实际环境修改"
    },
    {
      "key": "token",
      "value": "your_jwt_token_here",
      "type": "string",
      "description": "JWT认证令牌"
    },
    {
      "key": "reportId",
      "value": "report_001",
      "type": "string",
      "description": "报表ID示例"
    },
    {
      "key": "datasetId",
      "value": "dataset_001",
      "type": "string",
      "description": "数据集ID示例"
    },
    {
      "key": "templateKey",
      "value": "patient-stats",
      "type": "string",
      "description": "模板键名示例"
    }
  ]
} 